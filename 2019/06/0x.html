<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Kyle of Write | Creating an expandable image</title>
  <link rel="stylesheet" href="styles/reset.css">
  <link rel="stylesheet" href="styles/base.css">
  <link rel="stylesheet" href="styles/media.css">

  <style>
    body {
      max-width: 75em;
    }

    code {
      font-family: 'Courier New', Courier, monospace;
    }

    .step {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1em;
    }

    .step-image {
      display: inline-flex;
      flex-shrink: 0;
      overflow-y: hidden;
      margin-bottom: 0.5em;
    }

    .step-code {
      flex-grow: 1;
      width: 100%;
    }

    .diff {
      display: inline-flex;
      padding: 0.5em 1em;
      width: 100%;
      border: 0.08em solid #BBB;
      border-radius: 0.25em;
      background-color: #EEE;
      font-family: monospace;
      font-size: 1rem;
      overflow-x: auto;
      color: gray;
    }

    .diff + .diff {
      margin-top: 0.5em;
    }

    .add {
      color: #093;
    }

    .section-wrapper {
      display: inline-block;
      vertical-align: top;
    }

    .placeholder {
      vertical-align: top;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      width: 10em;
      height: 60em;
      background-image: linear-gradient(cyan, blue, black);
      color: white;
      font-weight: 600;
    }

    @media (min-width: 48em) {
      .step-image {
        margin-bottom: 0;
      }

      .step-code {
        width: 50%;
        margin-left: 0.5em;
      }
    }





    /* Start expandable stuffs */
    .expandable {
      position: relative;
      display: inline-flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      max-height: 180px;
      overflow-y: hidden;
      transition: 0.4s ease-in-out;
    }

    .expandable.expanded {
      max-height: 10000px;
    }

    .clickable {
      cursor: pointer;
    }

    .gradient:before {
      content:'';
      position: absolute;
      display: block;
      bottom: 0;
      width: 100%;
      min-height: 6em;
      height: calc(100% / 3);
      max-height: 12em;
      background-image: linear-gradient(transparent, #FAFAFA);
      transition: 0.4s ease-in-out;
    }

    .expandable-icon {
      position: absolute;
      display: inline-block;
      bottom: 1em;
      left: 50%;
      transform: translateX(-50%);
      width: 2.5em;
      height: 2.5em;
      color: black;
      transition: 0.4s ease-in-out;
    }

    .expandable-icon:before,
    .expandable-icon:after {
      content: '';
      position: absolute;
      display: inline-block;
      top: 25%;
      left: 48%;
      transform-origin: bottom;
      width: 0.2em;
      height: 1em;
      background-color: black;
    }

    .expandable-icon:before {
      transform: rotate(-45deg);
    }

    .expandable-icon:after {
      transform: rotate(45deg);
    }

    .expandable:hover .expandable-icon {
      color: yellow;
    }

    .expandable:hover .expandable-icon:before,
    .expandable:hover .expandable-icon:after {
      animation: arrow-bounce 1.2s linear 1.5s infinite;
    }

    .expandable.expanded:before,
    .expandable.expanded .expandable-icon {
      opacity: 0;
    }

    .expandable.expanded:hover:before,
    .expandable.expanded:hover .expandable-icon {
      opacity: 1;
    }

    .expandable.expanded .expandable-icon {
      transform: translateX(-50%) rotateX(180deg);
    }

    @keyframes arrow-bounce {
      0% { top: 25% }
      25% { top: 30% }
      50% { top: 25% }
      75% { top: 20% }
      100% { top: 25% }
    }
  </style>
</head>

<body>
  <h1>
    Creating an expandable image
  </h1>

  <p>
    One thing that can make a website look really snazzy is animation. It can make everything seem more interactive and fluid. However, it can also cause frustration on the user's end (and the developer's end). If an animation takes place many times, it's really annoying if it takes a long time to complete and you can't skip it. There are also some things that are notoriously difficult to animate effectively. This is also due to the fact that front-end developers have to support a variety of browsers and devices, as well as whatever settings the user has enabled if you want to make an accessible website. I want my site to be as usable as possible, to a reasonable extent. But I really don't want to support IE6. Fortunately, that isn't much of a concern for most web developers anymore. Only 0.39% of users are using IE9 and below, according to caniuse.com. Still, browsers are only progressing so quickly.
  </p>

  <p>
    One of the challenges developers face is allowing a section that is hiding an indeterminant amount of content expand to show all the information. Getting that interaction to animate smoothly is tough. Sure, you could do it all in Javascript, but it's more fun (to me) to do as much as possible with pure CSS. If anything, I usually only use JS to add a class to an element and then do the rest of the styling and animation changes from there. With that being said, here is my solution to the problem.
  </p>

  <div class="step">
    <p>
      <b>Step 1:</b> Start by hiding most of the image. We can accomplish this by wrapping the image in another element and setting an explicit height on the parent. Then we can use CSS to tell it to hide any content that overflows the container.
    </p>
    <div class="step-image">
      <div class="expandable">
        <img src="images/longcat.jpg" alt="Cat with a long body reaching up into space">
      </div>
    </div>
    <div class="step-code">
      <div class="diff">
        <pre class="add">&lt;div class=&quot;expandable&quot;&gt;
  &lt;img src=&quot;images/longcat.jpg&quot;
&lt;/div&gt;</pre>
      </div>
      <div class="diff">
        <pre class="add">.expandable {
  max-height: 180px;
  overflow-y: hidden;
}</pre>
      </div>
    </div>
  </div>

  <div class="step">
    <p>
      <b>Step 2:</b> Now we can get to work on the expanding aspect. Let's use Javascript set up a click listener on the parent element. This will allow the image to expand as long as the user clicks anywhere on the image.
    </p>
    <div class="step-image">
      <div class="expandable js-expandable">
        <img src="images/longcat.jpg" alt="Cat with a long body reaching up into space">
      </div>
    </div>
    <div class="step-code">
      <div class="diff">
        <pre>&lt;div class=&quot;expandable <span class="add">js-expandable</span>&quot;&gt;
  &lt;img src=&quot;images/longcat.jpg&quot;
&lt;/div&gt;</pre>
      </div>
      <div class="diff">
        <pre class="add">.expandable.expanded {
  max-height: 500px;
}</pre>
      </div>
      <div class="diff">
        <pre class="add">document.querySelectorAll('.js-expandable').forEach(function(el) {
  el.addEventListener('click', function() {
    if (this.classList.contains('expanded')) {
      this.classList.remove('expanded');
    } else {
      this.classList.add('expanded');
    }
  })
});</pre>
      </div>
      <p>
        Setting up your click listener this way allows you to have multiple expandable images on the screen at once. We are finding any element with the class <code>js-expandable</code>, looping over that list of items we found, and setting up the event listener for any time we click on our chosen element. Then inside the listener function, we check to see if it already has this class <code>expanded</code>, adding it if it is not there, or removing it if it is. That gives us the ability to expand and collapse each time we click the image.
      </p>
    </div>
  </div>

  <div class="diff">
    <pre class="add">
<div class="expandable js-expandable">
  <img src="images/longcat.jpg" alt="Cat with a long body reaching up into space">
  <div class="expandable-icon"></div>
</div>
&lt;div class=&quot;expandable&quot;&gt;
  &lt;img src=&quot;images/longcat.jpg&quot;
  &lt;div class=&quot;expandable-icon&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
.expandable {
  position: relative;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  max-height: 8em;
  overflow-y: hidden;
  transition: 0.4s ease-in-out;
  cursor: pointer;
}
    </pre>

  .expandable.expanded {
    max-height: 500px;
  }

  .expandable:before {
    content:'';
    position: absolute;
    display: block;
    bottom: 0;
    width: 100%;
    min-height: 6em;
    height: calc(100% / 3);
    max-height: 12em;
    background-image: linear-gradient(transparent, #FAFAFA);
    transition: 0.4s ease-in-out;
  }

  .expandable-icon {
    position: absolute;
    display: inline-block;
    bottom: 1em;
    left: 50%;
    transform: translateX(-50%);
    width: 2.5em;
    height: 2.5em;
    color: black;
    transition: 0.4s ease-in-out;
  }

  .expandable-icon:before,
  .expandable-icon:after {
    content: '';
    position: absolute;
    display: inline-block;
    top: 25%;
    left: 48%;
    transform-origin: bottom;
    width: 0.2em;
    height: 1em;
    background-color: black;
  }

  .expandable-icon:before {
    transform: rotate(-45deg);
  }

  .expandable-icon:after {
    transform: rotate(45deg);
  }

  .expandable:hover .expandable-icon {
    color: yellow;
  }

  .expandable:hover .expandable-icon:before,
  .expandable:hover .expandable-icon:after {
    animation: arrow-bounce 1.2s linear 1.5s infinite;
  }

  .expandable.expanded:before,
  .expandable.expanded .expandable-icon {
    opacity: 0;
  }

  .expandable.expanded:hover:before,
  .expandable.expanded:hover .expandable-icon {
    opacity: 1;
  }

  .expandable.expanded .expandable-icon {
    transform: translateX(-50%) rotateX(180deg);
  }

  @keyframes arrow-bounce {
    0% { top: 25% }
    25% { top: 30% }
    50% { top: 25% }
    75% { top: 20% }
    100% { top: 25% }
  }
</div>

  <script>
    document.querySelectorAll('.js-expandable').forEach(function(el) {
      el.addEventListener('click', function() {
        if (this.classList.contains('expanded')) {
          this.classList.remove('expanded');
        } else {
          this.classList.add('expanded');
        }
      })
    });
  </script>

</body>

</html>
